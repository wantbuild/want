local want = import "want";
local golang = import "recipes/golang.libsonnet";

local modSrc = want.selectDir(DERIVED, "./go_src.want");

local platforms = [
    ["amd64", "linux"],
    ["arm64", "linux"],
];

std.map(function(x)
    local goarch = x[0];
    local goos = x[1];
    local exec = golang.makeExec(modSrc, "cmd/want", goarch, goos);
    want.put(want.unit("./out/want_" + goarch + "_" + goos), exec)
, platforms)
